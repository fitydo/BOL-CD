[supervisord]
nodaemon=true
user=root
logfile=/var/log/supervisor/supervisord.log
pidfile=/var/run/supervisord.pid

[program:nginx]
command=/usr/sbin/nginx -g "daemon off;"
autostart=true
autorestart=true
priority=10
stdout_logfile=/var/log/bolcd/nginx.stdout.log
stderr_logfile=/var/log/bolcd/nginx.stderr.log

[program:bolcd-api]
command=gunicorn src.bolcd.api.app:app -k uvicorn.workers.UvicornWorker --workers 4 --bind 0.0.0.0:8080 --timeout 120 --access-logfile /var/log/bolcd/api-access.log --error-logfile /var/log/bolcd/api-error.log
directory=/app
user=bolcd
autostart=true
autorestart=true
priority=20
environment=PYTHONPATH="/app/src:%(ENV_PYTHONPATH)s"
stdout_logfile=/var/log/bolcd/api.stdout.log
stderr_logfile=/var/log/bolcd/api.stderr.log

[program:bolcd-worker]
command=python -m src.bolcd.worker.main
directory=/app
user=bolcd
autostart=true
autorestart=true
priority=30
environment=PYTHONPATH="/app/src:%(ENV_PYTHONPATH)s"
stdout_logfile=/var/log/bolcd/worker.stdout.log
stderr_logfile=/var/log/bolcd/worker.stderr.log

[program:bolcd-scheduler]
command=python -m src.bolcd.scheduler.main
directory=/app
user=bolcd
autostart=true
autorestart=true
priority=40
environment=PYTHONPATH="/app/src:%(ENV_PYTHONPATH)s"
stdout_logfile=/var/log/bolcd/scheduler.stdout.log
stderr_logfile=/var/log/bolcd/scheduler.stderr.log

[group:bolcd]
programs=nginx,bolcd-api,bolcd-worker,bolcd-scheduler
